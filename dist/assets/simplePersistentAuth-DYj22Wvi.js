const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-4-TitqP3.js","assets/index.css"])))=>i.map(i=>d[i]);
import{C as s,_ as c}from"./index-4-TitqP3.js";class _{async saveVendorLogin(e,t){try{if(s.isNativePlatform()){const{Preferences:o}=await c(async()=>{const{Preferences:n}=await import("./index-4-TitqP3.js").then(r=>r.i);return{Preferences:n}},__vite__mapDeps([0,1]));await o.set({key:"vendor_token",value:e}),await o.set({key:"vendor_user",value:JSON.stringify(t)}),await o.set({key:"vendor_time",value:Date.now().toString()})}else localStorage.setItem("vendor_token",e),localStorage.setItem("vendor_user",JSON.stringify(t)),localStorage.setItem("vendor_time",Date.now().toString());console.log("‚úÖ Vendor login saved")}catch(o){console.error("Save vendor login failed:",o)}}async getVendorAuth(){try{let e=null,t=null,o=null;if(console.log("üîç Getting vendor auth, isNative:",s.isNativePlatform()),s.isNativePlatform()){const{Preferences:l}=await c(async()=>{const{Preferences:d}=await import("./index-4-TitqP3.js").then(m=>m.i);return{Preferences:d}},__vite__mapDeps([0,1])),u=await l.get({key:"vendor_token"}),g=await l.get({key:"vendor_user"}),v=await l.get({key:"vendor_time"});e=u.value,t=g.value,o=v.value}else e=localStorage.getItem("vendor_token"),t=localStorage.getItem("vendor_user"),o=localStorage.getItem("vendor_time");if(console.log("üìä Storage check:",{token:e?"exists":"missing",user:t?"exists":"missing",time:o?"exists":"missing"}),!e||!t||!o)return console.log("‚ùå Missing auth data in storage"),null;const n=parseInt(o),r=30*24*60*60*1e3,i=Date.now()-n;if(console.log("‚è∞ Auth age check:",{loginTime:new Date(n).toISOString(),ageHours:Math.round(i/(1e3*60*60)),maxAgeHours:Math.round(r/(1e3*60*60)),isValid:i<=r}),i>r)return console.log("‚ùå Auth expired, clearing"),await this.clearVendorAuth(),null;const a=JSON.parse(t);return console.log("‚úÖ Vendor auth found:",{username:a.username,user_type:a.user_type,available_roles:a.available_roles}),{token:e,user:a}}catch(e){return console.error("‚ùå Get vendor auth failed:",e),null}}async clearVendorAuth(){try{if(s.isNativePlatform()){const{Preferences:e}=await c(async()=>{const{Preferences:t}=await import("./index-4-TitqP3.js").then(o=>o.i);return{Preferences:t}},__vite__mapDeps([0,1]));await e.remove({key:"vendor_token"}),await e.remove({key:"vendor_user"}),await e.remove({key:"vendor_time"})}else localStorage.removeItem("vendor_token"),localStorage.removeItem("vendor_user"),localStorage.removeItem("vendor_time");console.log("üóëÔ∏è Vendor auth cleared")}catch(e){console.error("Clear vendor auth failed:",e)}}async isVendorLoggedIn(){var t;const e=await this.getVendorAuth();return e!==null&&((t=e.user)==null?void 0:t.user_type)==="vendor"}}const f=new _;export{f as simplePersistentAuth};
